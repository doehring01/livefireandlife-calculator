<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Net Worth Tracker • FIREandLife</title>
  <link rel="stylesheet" href="/styles.css?v=20250811c" />
  <!-- GA -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KHKJVXPJQM"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config','G-KHKJVXPJQM');
  </script>
  <style>
    :root{ --bg:#ffffff; --soft:#f7fafc; --border:#e9edf2; --ink:#0f172a; --muted:#475569; --accent:#ff6b5d; --accent-ink:#fff; }
    body{background:var(--bg); color:var(--ink);}
    .container{max-width:1100px;margin:2rem auto;padding:0 1rem;}
    .grid{display:grid;gap:1rem}
    .grid-12{grid-template-columns:repeat(12,1fr)}
    .span-12{grid-column:span 12} .span-6{grid-column:span 6} .span-4{grid-column:span 4} .span-3{grid-column:span 3}
    .card{background:#fff;border:1px solid var(--border);border-radius:.6rem;padding:1rem}
    .soft{background:var(--soft);border:1px solid var(--border);border-radius:.6rem;padding:1rem}
    .muted{color:var(--muted)}
    table{width:100%;border-collapse:collapse}
    th,td{padding:.55rem;border-bottom:1px solid #eef2f7;vertical-align:middle}
    .actions button{padding:.35rem .55rem;border:1px solid #cbd5e1;border-radius:.35rem;background:#fff}
    .btn{padding:.7rem .9rem;border:none;border-radius:.45rem;background:var(--accent);color:var(--accent-ink);font-size:16px;cursor:pointer}
    .btn.secondary{background:#fff;color:#111;border:1px solid #cbd5e1}
    .tabs{display:flex;gap:.5rem;margin:1rem 0}
    .tabs button{background:#fff;border:1px solid #cbd5e1;border-radius:999px;padding:.5rem .9rem;cursor:pointer}
    .tabs button.active{background:var(--ink);border-color:var(--ink);color:#fff}
    .summary{position:sticky;top:0;z-index:10;background:var(--bg);padding:.5rem 0;margin-bottom:.5rem}
    .accordion > summary{cursor:pointer;list-style:none;padding:.6rem .25rem;border-bottom:1px solid #eef2f7;font-weight:600}
    .accordion[open] > summary{border-bottom:none}
    .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:1rem;z-index:50}
    .modal{max-width:520px;width:100%;background:#fff;border:1px solid var(--border);border-radius:.7rem;padding:1rem}
    label{display:block;font-weight:600;margin-bottom:.25rem}
    input,select{width:100%;padding:.7rem .75rem;border:1px solid #cfd8e3;border-radius:.4rem;font-size:16px;background:#fff}
    #toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:#111;color:#fff;padding:.6rem .9rem;border-radius:.5rem;opacity:0;pointer-events:none;transition:opacity .25s;z-index:60}
    .quick{display:grid;grid-template-columns: 1fr 1fr 2fr 1fr 1fr auto; gap:.5rem; align-items:end}
    .quick .btn{height:42px}
    @media (max-width: 800px){
      .grid-12{grid-template-columns:repeat(6,1fr)}
      .span-6,.span-4,.span-3,.span-12{grid-column:1 / -1}
      .quick{grid-template-columns: 1fr 1fr; }
      .quick .full{grid-column:1 / -1}
    }
  </style>
</head>
<body>
<header>
  <nav style="display:flex;justify-content:space-between;align-items:center;padding:1rem;background:#fff;box-shadow:0 2px 4px rgba(0,0,0,0.06);">
    <div class="logo"><img src="/assets/logo-horizontal.png" alt="FIREandLife" style="height:40px;"></div>
    <ul class="nav-links" style="list-style:none;display:flex;gap:1.2rem;margin:0;">
      <li><a href="/">Home</a></li>
      <li><a href="/calculators/" aria-current="page">Calculators</a></li>
      <li><a href="/blog/">Blog</a></li>
      <li><a href="/about/">About</a></li>
      <li><a href="/contact/">Contact</a></li>
    </ul>
  </nav>
</header>

<main class="container">
  <h1>Net Worth Tracker</h1>
  <p class="muted" style="margin:.25rem 0 1rem">Track your accounts privately in your browser. Mark which assets <strong>count toward FI</strong> (home equity/car usually don’t). Snapshot monthly to build your chart.</p>

  <section class="summary grid grid-12">
    <div class="span-3 soft"><strong>Total Assets</strong><div id="totalAssets">$0</div></div>
    <div class="span-3 soft"><strong>Total Liabilities</strong><div id="totalLiabilities">$0</div></div>
    <div class="span-3 soft"><strong>Net Worth</strong><div id="netWorth">$0</div></div>
    <div class="span-3 soft"><strong>FI-Eligible Assets</strong><div id="fiEligibleTotal">$0</div><small class="muted">Items marked “Counts toward FI.”</small></div>
  </section>

  <div class="tabs">
    <button class="active" data-tab="items">Accounts</button>
    <button data-tab="history">History</button>
  </div>

  <!-- Accounts -->
  <section id="tab-items">
    <div class="card" style="margin-bottom:.75rem">
      <h3 style="margin:.25rem 0">Quick add</h3>
      <div class="quick">
        <div>
          <label for="qType">Type</label>
          <select id="qType"><option value="asset">Asset</option><option value="liability">Liability</option></select>
        </div>
        <div>
          <label for="qCategory">Category</label>
          <select id="qCategory">
            <option>Checking</option><option>Savings</option><option>Brokerage</option>
            <option>401k/IRA</option><option>HSA</option><option>Home Equity</option>
            <option>Car</option><option>Other</option>
          </select>
        </div>
        <div class="full">
          <label for="qName">Name</label>
          <input id="qName" type="text" placeholder="e.g., Vanguard Brokerage"/>
        </div>
        <div>
          <label for="qAmount">Amount</label>
          <input id="qAmount" type="number" inputmode="decimal" step="0.01" min="0" value="0"/>
        </div>
        <div>
          <label for="qFi">Counts toward FI?</label>
          <select id="qFi"><option value="yes" selected>Yes</option><option value="no">No</option></select>
        </div>
        <div>
          <label>&nbsp;</label>
          <button id="qAdd" class="btn" type="button">Add</button>
        </div>
      </div>
      <small class="muted" style="display:block;margin-top:.5rem">Tip: Primary home/car are usually <em>not</em> FI-eligible, but you can override.</small>
    </div>

    <div class="grid grid-12">
      <div class="span-6 card">
        <h3 style="margin:.25rem 0">Asset Mix</h3>
        <small class="muted">FI-eligible vs not-eligible highlighted.</small>
        <canvas id="mixChart" height="220" aria-label="Asset mix pie"></canvas>
      </div>
      <div class="span-6 card">
        <details class="accordion" open>
          <summary>Assets</summary>
          <table>
            <thead><tr><th style="text-align:left">Name</th><th>Category</th><th style="text-align:center">FI?</th><th style="text-align:right">Amount</th><th style="text-align:right">Actions</th></tr></thead>
            <tbody id="assetsBody"></tbody>
          </table>
        </details>
        <details class="accordion" open style="margin-top:.5rem">
          <summary>Liabilities</summary>
          <table>
            <thead><tr><th style="text-align:left">Name</th><th>Category</th><th style="text-align:center">—</th><th style="text-align:right">Amount</th><th style="text-align:right">Actions</th></tr></thead>
            <tbody id="liabilitiesBody"></tbody>
          </table>
        </details>
      </div>
    </div>
  </section>

  <!-- History -->
  <section id="tab-history" hidden>
    <div class="card">
      <div style="display:flex;gap:.5rem;flex-wrap:wrap;justify-content:space-between;align-items:center">
        <div>
          <h3 style="margin:.25rem 0">Net Worth History</h3>
          <div class="muted">Snapshot monthly to build your trend.</div>
        </div>
        <div class="row">
          <button class="btn" id="snapshotBtn" type="button">Snapshot this month</button>
          <button class="btn secondary" id="exportCsvBtn" type="button">Export CSV</button>
        </div>
      </div>
      <div style="margin-top:1rem">
        <canvas id="nwChart" height="210" aria-label="Net worth history"></canvas>
      </div>
      <div style="margin-top:1rem;overflow:auto">
        <table>
          <thead><tr><th style="text-align:left">Date</th><th style="text-align:right">Net Worth</th></tr></thead>
          <tbody id="historyBody"></tbody>
        </table>
      </div>
    </div>
  </section>
</main>

<!-- Modal: Edit item -->
<div class="backdrop" id="backdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <h3 id="modalTitle" style="margin:.25rem 0">Edit Item</h3>
    <form id="itemForm" class="grid" style="grid-template-columns:repeat(2,1fr); gap:.75rem; align-items:end">
      <input type="hidden" id="editId" value="">
      <div class="span-12">
        <label for="itemType">Type</label>
        <select id="itemType">
          <option value="asset">Asset</option>
          <option value="liability">Liability</option>
        </select>
      </div>
      <div>
        <label for="itemCategory">Category</label>
        <select id="itemCategory">
          <option>Checking</option><option>Savings</option><option>Brokerage</option>
          <option>401k/IRA</option><option>HSA</option><option>Home Equity</option>
          <option>Car</option><option>Other</option>
        </select>
      </div>
      <div>
        <label for="itemCountsFi">Counts toward FI?</label>
        <select id="itemCountsFi">
          <option value="yes">Yes</option>
          <option value="no">No</option>
        </select>
        <small class="help">Primary home/car usually “No”.</small>
      </div>
      <div class="span-12">
        <label for="itemName">Name</label>
        <input id="itemName" type="text" placeholder="e.g., Vanguard Brokerage" />
      </div>
      <div class="span-12">
        <label for="itemAmount">Amount</label>
        <input id="itemAmount" type="number" inputmode="decimal" step="0.01" min="0" value="0" />
      </div>
      <div class="span-12" style="display:flex;gap:.5rem;flex-wrap:wrap">
        <button class="btn" type="submit" id="saveBtn">Update item</button>
        <button class="btn secondary" type="button" id="cancelBtn">Cancel</button>
      </div>
    </form>
  </div>
</div>

<div id="toast">Saved</div>

<footer><p style="text-align:center;padding:1rem;">&copy; <span id="year"></span> FIRE and Life.</p></footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
(function(){
  // ==== Utilities ====
  function $(id){ return document.getElementById(id); }
  function fmt(n){ return n.toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:0}); }
  function uid(){ return Math.random().toString(36).slice(2,9); }
  function showToast(msg){ var t=$('toast'); t.textContent=msg||'Saved'; t.style.opacity='1'; setTimeout(function(){ t.style.opacity='0'; },1400); }
  $('year').textContent = new Date().getFullYear();

  // ==== Storage keys ====
  var STORAGE_ITEMS_V2='lf_nw_items_v2';
  var STORAGE_ITEMS_V1='lf_nw_items_v1';
  var STORAGE_HISTORY='lf_nw_history_v1';

  function migrateIfNeeded(){
    var v2 = localStorage.getItem(STORAGE_ITEMS_V2);
    if (v2) { try{ return JSON.parse(v2)||[]; }catch(e){ return []; } }
    var v1 = localStorage.getItem(STORAGE_ITEMS_V1);
    if (!v1) return [];
    var items=[];
    try { items = JSON.parse(v1)||[]; } catch(e){ items=[]; }
    var upgraded = items.map(function(it){
      return {
        id: it.id || uid(),
        type: it.type || 'asset',
        name: it.name || 'Item',
        amount: +it.amount || 0,
        category: 'Other',
        countsFi: true
      };
    });
    localStorage.setItem(STORAGE_ITEMS_V2, JSON.stringify(upgraded));
    return upgraded;
  }
  function loadItems(){ return migrateIfNeeded(); }
  function saveItems(items){ localStorage.setItem(STORAGE_ITEMS_V2, JSON.stringify(items)); }
  function loadHistory(){ try{ return JSON.parse(localStorage.getItem(STORAGE_HISTORY)) || []; }catch(e){ return []; } }
  function saveHistory(history){ localStorage.setItem(STORAGE_HISTORY, JSON.stringify(history)); }

  // ==== State ====
  var items = loadItems();
  var history = loadHistory();
  if (items.length) {
    items = items.map(function(i){
      return {
        id: i.id || uid(),
        type: i.type || 'asset',
        name: i.name || 'Item',
        amount: +i.amount || 0,
        category: i.category || 'Other',
        countsFi: (i.category==='Home Equity'||i.category==='Car') ? false : (typeof i.countsFi==='boolean' ? i.countsFi : true)
      };
    });
    saveItems(items);
  }
  if (items.length === 0){
    items = [
      { id: uid(), type:'asset', name:'Checking', category:'Checking', amount:3000, countsFi:true },
      { id: uid(), type:'asset', name:'Brokerage', category:'Brokerage', amount:15000, countsFi:true },
      { id: uid(), type:'asset', name:'Home Equity', category:'Home Equity', amount:80000, countsFi:false },
      { id: uid(), type:'liability', name:'Credit Card', category:'Other', amount:500, countsFi:false }
    ];
    saveItems(items);
  }

  // ==== DOM refs ====
  var assetsBody=$('assetsBody'), liabilitiesBody=$('liabilitiesBody'), historyBody=$('historyBody');
  var totalAssetsEl=$('totalAssets'), totalLiabilitiesEl=$('totalLiabilities'), netWorthEl=$('netWorth'), fiEligibleTotalEl=$('fiEligibleTotal');

  // Quick add refs
  var qType=$('qType'), qCategory=$('qCategory'), qName=$('qName'), qAmount=$('qAmount'), qFi=$('qFi'), qAdd=$('qAdd');

  // Modal refs
  var backdrop=$('backdrop'), itemForm=$('itemForm');
  var editId=$('editId'), itemType=$('itemType'), itemCategory=$('itemCategory'), itemCountsFi=$('itemCountsFi'), itemName=$('itemName'), itemAmount=$('itemAmount'), saveBtn=$('saveBtn'), cancelBtn=$('cancelBtn');

  // Tabs
  var tabBtns = document.querySelectorAll('.tabs button');
  for (var i=0;i<tabBtns.length;i++){
    tabBtns[i].addEventListener('click', function(){
      for (var j=0;j<tabBtns.length;j++) tabBtns[j].classList.remove('active');
      this.classList.add('active');
      var tab=this.getAttribute('data-tab');
      $('tab-items').hidden = (tab !== 'items');
      $('tab-history').hidden = (tab !== 'history');
    });
  }

  // Charts
  var ctxMix = $('mixChart').getContext('2d');
  var nwCanvas = $('nwChart');
  var ctxNW = nwCanvas ? nwCanvas.getContext('2d') : null;
  var chartMix=null, chartNW=null;

  function computeTotals(){
    var assets = items.filter(function(i){return i.type==='asset';}).reduce(function(s,i){return s+(+i.amount||0);},0);
    var liabs  = items.filter(function(i){return i.type==='liability';}).reduce(function(s,i){return s+(+i.amount||0);},0);
    var fiElig = items.filter(function(i){return i.type==='asset' && i.countsFi;}).reduce(function(s,i){return s+(+i.amount||0);},0);
    return { assets:assets, liabs:liabs, net:assets-liabs, fiElig:fiElig };
  }

  function renderSummary(){
    var t=computeTotals();
    totalAssetsEl.textContent = fmt(t.assets);
    totalLiabilitiesEl.textContent = fmt(t.liabs);
    netWorthEl.textContent = fmt(t.net);
    fiEligibleTotalEl.textContent = fmt(t.fiElig);
  }

  function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g,function(m){return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]);}); }

  function addRow(tbody,isAsset){
    return function(i){
      var tr=document.createElement('tr');
      var fiCell = isAsset ? '<td style="text-align:center">'+(i.countsFi?'✅':'—')+'</td>' : '<td style="text-align:center">—</td>';
      tr.innerHTML =
        '<td>'+escapeHtml(i.name)+'</td>'+
        '<td>'+escapeHtml(i.category||'Other')+'</td>'+
        fiCell+
        '<td style="text-align:right">'+fmt(+i.amount||0)+'</td>'+
        '<td style="text-align:right" class="actions">'+
          '<button data-act="edit" data-id="'+i.id+'">Edit</button> '+
          '<button data-act="del" data-id="'+i.id+'">Delete</button>'+
        '</td>';
      tbody.appendChild(tr);
    };
  }

  function renderMixPie(){
    var map={}; // key: "category|fi"
    items.filter(function(i){return i.type==='asset';}).forEach(function(i){
      var key=(i.category||'Other')+'|'+(i.countsFi?'fi':'nfi');
      map[key]=(map[key]||0)+(+i.amount||0);
    });
    var labels=[], data=[], bg=[];
    for (var key in map){
      if (!map.hasOwnProperty(key)) continue;
      var parts=key.split('|'); var cat=parts[0], flag=parts[1];
      labels.push(cat+' '+(flag==='fi'?'(FI)':'(non-FI)'));
      data.push(map[key]);
      bg.push(flag==='fi' ? 'rgba(26,115,232,.35)' : 'rgba(203,213,225,.7)');
    }
    if (chartMix) chartMix.destroy();
    chartMix = new Chart(ctxMix,{type:'pie',data:{labels:labels,datasets:[{data:data,backgroundColor:bg}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom'}}}});
  }

  function renderLists(){
    assetsBody.innerHTML=''; liabilitiesBody.innerHTML='';
    items.filter(function(i){return i.type==='asset';}).forEach(addRow(assetsBody,true));
    items.filter(function(i){return i.type==='liability';}).forEach(addRow(liabilitiesBody,false));
    renderSummary(); renderMixPie();
  }

  function renderHistory(){
    if (!ctxNW) return;
    historyBody.innerHTML='';
    history.forEach(function(h){
      var tr=document.createElement('tr');
      var d=new Date(h.dateISO);
      tr.innerHTML='<td>'+d.toLocaleDateString(undefined,{year:'numeric',month:'short'})+'</td><td style="text-align:right">'+fmt(h.netWorthNumber)+'</td>';
      historyBody.appendChild(tr);
    });
    var labels=history.map(function(h){ return new Date(h.dateISO).toLocaleDateString(undefined,{year:'2-digit',month:'short'}); });
    var data=history.map(function(h){ return h.netWorthNumber; });
    if (chartNW) chartNW.destroy();
    chartNW = new Chart(ctxNW,{type:'line',data:{labels:labels,datasets:[{label:'Net worth',data:data,borderWidth:2,fill:false,tension:.15,pointRadius:2}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{y:{ticks:{callback:function(v){return fmt(v);}}}}});
  }

  // Quick add
  function addQuick(){
    var entry={
      id: uid(),
      type: qType.value,
      category: qCategory.value || 'Other',
      name: (qName.value||'').trim() || (qType.value==='asset'?'Asset':'Liability'),
      amount: parseFloat(qAmount.value||'0') || 0,
      countsFi: (qType.value==='asset') ? (qFi.value==='yes') : false
    };
    items.push(entry);
    saveItems(items);
    renderLists();
    showToast('Item added');
    qName.value=''; qAmount.value='0'; qName.focus();
  }
  $('qAdd').addEventListener('click', addQuick);
  qName.addEventListener('keydown', function(e){ if(e.key==='Enter'){ e.preventDefault(); addQuick(); }});
  qAmount.addEventListener('keydown', function(e){ if(e.key==='Enter'){ e.preventDefault(); addQuick(); }});

  // Edit modal
  function openModal(editItem){
    if (!editItem) return;
    backdrop.style.display='flex'; backdrop.setAttribute('aria-hidden','false');
    $('modalTitle').textContent='Edit Item';
    editId.value=editItem.id;
    itemType.value=editItem.type;
    itemCategory.value=editItem.category || 'Other';
    itemCountsFi.value=editItem.countsFi ? 'yes' : 'no';
    itemName.value=editItem.name || '';
    itemAmount.value=(editItem.amount!=null ? editItem.amount : 0);
    saveBtn.textContent='Update item';
    setTimeout(function(){ itemName.focus(); },50);
  }
  function closeModal(){ backdrop.style.display='none'; backdrop.setAttribute('aria-hidden','true'); }
  cancelBtn.addEventListener('click', closeModal);
  backdrop.addEventListener('click', function(e){ if (e.target===backdrop) closeModal(); });
  document.addEventListener('keydown', function(e){ if (e.key==='Escape') closeModal(); });

  function onTableClick(e){
    var btn=e.target.closest ? e.target.closest('button[data-act]') : null;
    if (!btn) return;
    var id=btn.getAttribute('data-id');
    var act=btn.getAttribute('data-act');
    var it=items.find(function(x){return x.id===id;});
    if (!it) return;
    if (act==='edit'){ openModal(it); }
    if (act==='del'){ items=items.filter(function(x){return x.id!==id;}); saveItems(items); renderLists(); }
  }
  assetsBody.addEventListener('click', onTableClick);
  liabilitiesBody.addEventListener('click', onTableClick);

  itemForm.addEventListener('submit', function(e){
    e.preventDefault();
    var id=editId.value.trim();
    var entry={
      id:id,
      type:itemType.value,
      category:itemCategory.value || 'Other',
      name:(itemName.value||'').trim() || (itemType.value==='asset'?'Asset':'Liability'),
      amount: parseFloat(itemAmount.value||'0') || 0,
      countsFi: (itemType.value==='asset') ? (itemCountsFi.value==='yes') : false
    };
    items=items.map(function(it){ return it.id===id ? entry : it; });
    saveItems(items);
    renderLists();
    showToast('Updated');
    closeModal();
  });

  // History
  $('snapshotBtn').addEventListener('click', function(){
    var t=computeTotals();
    var now=new Date();
    var monthKey=new Date(now.getFullYear(), now.getMonth(), 1).toISOString();
    var idx=history.findIndex(function(h){return h.dateISO===monthKey;});
    var entry={ dateISO: monthKey, netWorthNumber: t.net };
    if (idx>=0) history[idx]=entry; else history.push(entry);
    history.sort(function(a,b){ return new Date(a.dateISO)-new Date(b.dateISO); });
    saveHistory(history); renderHistory();
  });

  $('exportCsvBtn').addEventListener('click', function(){
    var rows=[['Date','Net Worth']];
    history.forEach(function(h){ rows.push([ new Date(h.dateISO).toISOString().slice(0,10), h.netWorthNumber ]); });
    var csv=rows.map(function(r){return r.join(',');}).join('\n');
    var blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});
    var url=URL.createObjectURL(blob); var a=document.createElement('a');
    a.href=url; a.download='net-worth-history.csv'; a.click(); URL.revokeObjectURL(url);
  });

  // Initial
  renderLists(); renderHistory();
})();
<script src="/calculators/net-worth-tracker.inline.js" defer></script>
</body>
</html>
